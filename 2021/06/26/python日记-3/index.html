<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="John Doe">





<title>python日记-3 | Hexo</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Zhanghan&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Zhanghan&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">python日记-3</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">John Doe</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">June 26, 2021&nbsp;&nbsp;9:31:34</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>本篇文章对应董付国老师网课的7,8,9章。</p>
<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><p>python中的字符串是不可变序列，凡是对字符串修改的方法都是生成新的字符串。</p>
<p>字符串的定界符是<code>‘ ’</code>或<code>“ ”</code>或<code>‘’‘ ’‘’</code>，使用哪一种定界符主要取决于字符串中是否有与定界符相同的字符，如果有就使用其他的定界符，使用起来比较灵活。</p>
<p>字符串除了支持序列通用方法（双向索引、比较大小、计算长度、元素访问、切片、成员测试等）以外，还支持一些字符串特有的操作，例如格式化、查找、替换、排版等。</p>
<p>python支持Unicode编码的str类型的字符串，也支持字节串类型bytes。str类型字符串可以通过<code>encode()</code>方法编码成bytes对象，bytes对象则可以通过<code>decode()</code>方法使用指定编码格式解码成str字符串。</p>
<h2 id="字符串编码格式"><a href="#字符串编码格式" class="headerlink" title="字符串编码格式"></a>字符串编码格式</h2><p>ASCII码用一个字节表示1个字符，只能表示255个字符。</p>
<p>GB2312、GB2312的扩充GBK、微软在GBK基础上开发的CP936是常用的中文编码，都是用2个字节表示中文，1个字节表示英文。</p>
<p>UTF-8对全世界所有国家需要用到的字符进行了编码，用1个字节表示英语字符，3个字节表示中文，其他语言的字符使用2个或4个字节。</p>
<h2 id="原始字符串"><a href="#原始字符串" class="headerlink" title="原始字符串"></a>原始字符串</h2><p>为了避免字符串中的转义字符进行转义，可以在字符串前面加上字母r或R表示原始字符串，这样字符串中的所有字符都表示原始的含义而不会进行任何转义。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>path = <span class="string">&#x27;C:\Windows\notepad.exe&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(path)</span><br><span class="line">C:\Windows</span><br><span class="line">ntepad.exe</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>path = <span class="string">r&#x27;C:\Windows\notepad.exe&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(path)</span><br><span class="line">C:\Windows\notepad.exe</span><br></pre></td></tr></table></figure>

<p>还有一种方法，将<code>\</code>换成<code>\\</code>表示不是转义字符</p>
<h2 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h2><h3 id="运算符"><a href="#运算符" class="headerlink" title="%运算符"></a>%运算符</h3><p>使用方法：</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/1.png" alt="1"></p>
<p>常用格式运算符</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/2.png" alt="2"></p>
<p>实例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1235</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;%o&quot;</span> % x</span><br><span class="line"><span class="string">&#x27;2323&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;%x&quot;</span> % x</span><br><span class="line"><span class="string">&#x27;4d3&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;%e&quot;</span> % x</span><br><span class="line"><span class="string">&#x27;1.235000e+03&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;%s&#x27;</span> % <span class="number">65</span></span><br><span class="line"><span class="string">&#x27;65&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="format方法"><a href="#format方法" class="headerlink" title="format方法"></a>format方法</h3><p>实例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="string">&quot;The number &#123;0:,&#125; in hex is: &#123;0:#x&#125;, the number &#123;1&#125; in oct is &#123;1:#o&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">5555</span>,<span class="number">55</span>))</span><br><span class="line">The number <span class="number">5</span>,<span class="number">555</span> <span class="keyword">in</span> <span class="built_in">hex</span> <span class="keyword">is</span>: <span class="number">0x15b3</span>, the number <span class="number">55</span> <span class="keyword">in</span> <span class="built_in">oct</span> <span class="keyword">is</span> <span class="number">0o67</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="string">&quot;The number &#123;1:,&#125; in hex is: &#123;1:#x&#125;, the number &#123;0&#125; in oct is &#123;0:o&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">5555</span>,<span class="number">55</span>))</span><br><span class="line">The number <span class="number">55</span> <span class="keyword">in</span> <span class="built_in">hex</span> <span class="keyword">is</span>: <span class="number">0x37</span>, the number <span class="number">5555</span> <span class="keyword">in</span> <span class="built_in">oct</span> <span class="keyword">is</span> <span class="number">12663</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="string">&quot;my name is &#123;name&#125;, my age is &#123;age&#125;, and my QQ is &#123;qq&#125;&quot;</span>.<span class="built_in">format</span>(name=<span class="string">&#x27;zhang han&#x27;</span>,age=<span class="number">40</span>,qq=<span class="string">&#x27;8580****&#x27;</span>))</span><br><span class="line">my name <span class="keyword">is</span> zhang han, my age <span class="keyword">is</span> <span class="number">40</span>, <span class="keyword">and</span> my QQ <span class="keyword">is</span> <span class="number">8580</span>****</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>从上面几个例子可以看出：</p>
<ol>
<li><code>format()</code>函数以{}加数字表示占位符，并且占位符里还可以使用格式运算符，只是将%换成#，也可以不加#。不加#号产生的效果是转换的数字没有进制前缀。</li>
<li>占位符可以多次格式化，顺序可以打乱</li>
<li>也可以使用关键参数的方式来表示占位符以及格式化</li>
</ol>
<h3 id="字符串常量格式化"><a href="#字符串常量格式化" class="headerlink" title="字符串常量格式化"></a>字符串常量格式化</h3><p>python 3.6开始支持，字符串前加f与format方法类似</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">&#x27;zhang&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>age = <span class="number">20</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f&#x27;My name is <span class="subst">&#123;name&#125;</span>, and I am <span class="subst">&#123;age&#125;</span> years old.&#x27;</span>  </span><br><span class="line"><span class="string">&#x27;My name is zhang, and I am 20 years old.&#x27;</span></span><br></pre></td></tr></table></figure>

<p>若占位符的变量不存在则会报错。</p>
<h2 id="字符串方法"><a href="#字符串方法" class="headerlink" title="字符串方法"></a>字符串方法</h2><h3 id="find-rfind-index-rindex-count"><a href="#find-rfind-index-rindex-count" class="headerlink" title="find(),rfind(),index(),rindex(),count()"></a>find(),rfind(),index(),rindex(),count()</h3><ul>
<li><p>find()和index()方法都是用来从左到右查找一个字符串在当前字符串里第一次出现的位置，而rfind()和rindex()则是从右向左查找。</p>
</li>
<li><p>find(),rfind()和index(),rindex()的区别就是find()和rfind()方法在查找结果为不存在时返回-1，index()和rindex()方法则是抛出异常。</p>
</li>
<li><p>count()方法用来返回一个字符串在当前字符串中出现的次数。</p>
</li>
</ul>
<h3 id="split-rsplit"><a href="#split-rsplit" class="headerlink" title="split(),rsplit()"></a>split(),rsplit()</h3><ul>
<li>这两个函数分别用来以指定字符串为分隔符，把当前字符串从左到右或从右到左分隔成多个字符串，返回分隔结果的列表。</li>
<li>如果不指定分隔符，则字符串中的任何空白符号（空格、换行符、制表符等）都会被认为是分隔符，并且多个空白字符会被认为是一个分隔符</li>
<li>如果指定了分隔符，那么连续多个分隔符或分隔符在开头或结尾时，分隔结果中会包含空字符串<code>‘’</code></li>
</ul>
<h3 id="lower-upper-capitalize-title-swapcase"><a href="#lower-upper-capitalize-title-swapcase" class="headerlink" title="lower(),upper(),capitalize(),title(),swapcase()"></a>lower(),upper(),capitalize(),title(),swapcase()</h3><ul>
<li>lower()将字符串全部转换成小写字母</li>
<li>upper()将字符串全部转换成大写字母</li>
<li>capitalize()将字符串的首字母转换成大写字母</li>
<li>title()将字符串每个单词的首字母转换成大写字母</li>
<li>swapcase()将字符串中的字母大小写互换</li>
<li>以上方法只对英文字母起作用，其他字符忽略</li>
</ul>
<h3 id="replace-maketrans-translate"><a href="#replace-maketrans-translate" class="headerlink" title="replace(),maketrans(),translate()"></a>replace(),maketrans(),translate()</h3><ul>
<li><p>replace(a，b)将字符串中<strong>所有</strong>a替换成b</p>
</li>
<li><p>maketrans()用来生成字符映射表，translate()用来根据字符映射表定义的映射欢喜转换字符串，替换其中的字符。这两个方法组合可以同时处理多个字符。使用方法见以下案例：凯撒加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">kaisa</span>(<span class="params">s, k</span>):</span></span><br><span class="line">	lower = string.ascii_lowercase</span><br><span class="line">	upper = string.ascii_uppercase</span><br><span class="line">	before = string.ascii_letters</span><br><span class="line">	after = lower[k:]+lower[:k]+upper[k:]+upper[:k]</span><br><span class="line">	table = <span class="string">&#x27;&#x27;</span>.maketrans(before,after)</span><br><span class="line">	<span class="keyword">return</span> s.translate(table)</span><br><span class="line">	</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;Python is a great programming language. I like it!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>kaisa(s,<span class="number">3</span>)</span><br><span class="line"><span class="string">&#x27;Sbwkrq lv d juhdw surjudpplqj odqjxdjh. L olnh lw!&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>&#39;&#39;.maketrans(before,after)</code>这句代码中before是原字符串，after是映射后的目标字符串，两字符串长度必须相等，映射规则是原字符串中的字符映射到目标字符串中相应位置的字符，生成一个字典，该字典的键值对是映射字符的ascii码。<code>maketrans()</code>前需要一个字符串来调用这个方法，字符串的值不影响结果。</p>
</li>
</ul>
<h3 id="strip-rstrip-lstrip"><a href="#strip-rstrip-lstrip" class="headerlink" title="strip(),rstrip(),lstrip()"></a>strip(),rstrip(),lstrip()</h3><ul>
<li>strip()的作用是清除字符串中左右两侧的空白字符</li>
<li>rstrip()是清除字符串中右侧的空白字符，lstrip()同理</li>
<li>这三个函数还可以指定删除的字符，参数传入一个字符串，则会删除原字符串中两个所有在参数字符串中的字符</li>
</ul>
<h3 id="startswith-endswith"><a href="#startswith-endswith" class="headerlink" title="startswith(),endswith()"></a>startswith(),endswith()</h3><ul>
<li>判断字符串是否以指定字符串开始或结束</li>
</ul>
<h3 id="isalnum-isalpha-isdigit-isspace-isupper-islower"><a href="#isalnum-isalpha-isdigit-isspace-isupper-islower" class="headerlink" title="isalnum(),isalpha(),isdigit(),isspace(),isupper(),islower()"></a>isalnum(),isalpha(),isdigit(),isspace(),isupper(),islower()</h3><ul>
<li>用来判断字符串是否为数字或字母、是否为字母、是否为数字、是否为空白字符、是否为大写字母、是否为小写字母，返回True或False</li>
</ul>
<h3 id="center-ljust-rjust"><a href="#center-ljust-rjust" class="headerlink" title="center(),ljust(),rjust()"></a>center(),ljust(),rjust()</h3><ul>
<li><p>返回指定宽度的新字符串，原字符串居中、左对齐、右对齐。</p>
</li>
<li><p>如果指定宽度大于字符串长度，则使用指定字符（默认空格）填充</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;Hello world!&#x27;</span>.center(<span class="number">20</span>)</span><br><span class="line"><span class="string">&#x27;    Hello world!    &#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;Hello world!&#x27;</span>.center(<span class="number">20</span>,<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;----Hello world!----&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;Hello world!&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;Hello world!========&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;Hello world!&#x27;</span>.rjust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;========Hello world!&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="适用于字符串对象的内置函数"><a href="#适用于字符串对象的内置函数" class="headerlink" title="适用于字符串对象的内置函数"></a>适用于字符串对象的内置函数</h2><h3 id="适用列表元组的内置函数"><a href="#适用列表元组的内置函数" class="headerlink" title="适用列表元组的内置函数"></a>适用列表元组的内置函数</h3><p>len(),max(),min(),zip(),sorted(),reversed(),enumerate(),map()等</p>
<h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><p>将任意字符串转化为python表达式并进行求值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;3+4&#x27;</span>)</span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure>

<h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><p>字符串也适用切片，但仅限于读取元素获得子串，不能用作修改。</p>
<h2 id="字符串常量"><a href="#字符串常量" class="headerlink" title="字符串常量"></a>字符串常量</h2><p>python标准库string中定义了数字字符、标点符号、英文字母、大写字母、小写字母等字符串常量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.digits</span><br><span class="line"><span class="string">&#x27;0123456789&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.punctuation</span><br><span class="line"><span class="string">&#x27;!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_letters</span><br><span class="line"><span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_lowercase</span><br><span class="line"><span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_uppercase</span><br><span class="line"><span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>characters = string.digits+string.ascii_letters</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="comment">#生成4位密码</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join([choice(characters) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])</span><br><span class="line"><span class="string">&#x27;7hBI&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="中英文分词"><a href="#中英文分词" class="headerlink" title="中英文分词"></a>中英文分词</h2><p>需要安装扩展库jieba。在spyder中安装扩展库的方法是打开Anaconda Prompt，直接使用pip命令安装。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> jieba</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">&#x27;我喜欢使用python编程&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(jieba.cut(x))					<span class="comment">#使用默认词库进行分词</span></span><br><span class="line">[<span class="string">&#x27;我&#x27;</span>, <span class="string">&#x27;喜欢&#x27;</span>, <span class="string">&#x27;使用&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;编程&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(jieba.cut(<span class="string">&#x27;纸杯&#x27;</span>))</span><br><span class="line">[<span class="string">&#x27;纸杯&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(jieba.cut(<span class="string">&#x27;花纸杯&#x27;</span>))</span><br><span class="line">[<span class="string">&#x27;花&#x27;</span>,<span class="string">&#x27;纸杯&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>jieba.add_word(<span class="string">&#x27;花纸杯&#x27;</span>)	<span class="comment">#添加词条</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>jieba.cut(<span class="string">&#x27;花纸杯&#x27;</span>)        <span class="comment">#使用新词库进行分词</span></span><br><span class="line">[<span class="string">&#x27;花纸杯&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h2 id="汉字到拼音的转换"><a href="#汉字到拼音的转换" class="headerlink" title="汉字到拼音的转换"></a>汉字到拼音的转换</h2><p>需要安装扩展库pypinyin。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pypinyin <span class="keyword">import</span> lazy_pinyin</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lazy_pinyin(<span class="string">&#x27;张函&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;zhang&#x27;</span>, <span class="string">&#x27;han&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lazy_pinyin(<span class="string">&#x27;张函&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">[<span class="string">&#x27;zhāng&#x27;</span>, <span class="string">&#x27;hán&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lazy_pinyin(<span class="string">&#x27;张函&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">[<span class="string">&#x27;zha1ng&#x27;</span>, <span class="string">&#x27;ha2n&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lazy_pinyin(<span class="string">&#x27;张函&#x27;</span>,<span class="number">3</span>)</span><br><span class="line">[<span class="string">&#x27;zh&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>而且支持区分多音字。</p>
<h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h3><p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/3.png" alt="3"></p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/4.png" alt="4"></p>
<p>其中，()表示一个子模式，{m,n}中不能有空格。</p>
<h2 id="扩展语法"><a href="#扩展语法" class="headerlink" title="扩展语法"></a>扩展语法</h2><p>主要是子模块的语法，用的比较少。</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/5.png" alt="5"></p>
<h2 id="正则表达式集锦"><a href="#正则表达式集锦" class="headerlink" title="正则表达式集锦"></a>正则表达式集锦</h2><p>主要用来查找使用。</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/6.png" alt="6"></p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/7.png" alt="7"></p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/8.png" alt="8"></p>
<p>值得注意的是，正则表达式只是在形式上对字符串进行检查。</p>
<h2 id="re模块"><a href="#re模块" class="headerlink" title="re模块"></a>re模块</h2><p>python标准库re模块提供了正则表达式操作所需要的功能。</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/9.png" alt="9"></p>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;alpha. beta....gamma delta&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">&#x27;[\. ]+&#x27;</span>, text)</span><br><span class="line">[<span class="string">&#x27;alpha&#x27;</span>, <span class="string">&#x27;beta&#x27;</span>, <span class="string">&#x27;gama&#x27;</span>, <span class="string">&#x27;delta&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;a s d&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.sub(<span class="string">&#x27;a|s|d&#x27;</span>, <span class="string">&#x27;good&#x27;</span>, s)</span><br><span class="line"><span class="string">&#x27;good good good&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>example = <span class="string">&#x27;Beautiful is better than ugly.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">&#x27;\\bb.+?\\b&#x27;</span>, example) 		<span class="comment">#以b开头的单词，此处的？表示非贪心模式</span></span><br><span class="line">[<span class="string">&#x27;better&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">&#x27;\\bb.+\\b&#x27;</span>, example)</span><br><span class="line">[<span class="string">&#x27;better than ugly&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">&#x27;\w+&#x27;</span>, example)</span><br><span class="line">[<span class="string">&#x27;Beautiful&#x27;</span>, <span class="string">&#x27;is&#x27;</span>, <span class="string">&#x27;better&#x27;</span>, <span class="string">&#x27;than&#x27;</span>, <span class="string">&#x27;ugly&#x27;</span>]	<span class="comment">#所有单词</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">&#x27;\s&#x27;</span>, example)</span><br><span class="line">[<span class="string">&#x27;Beautiful&#x27;</span>, <span class="string">&#x27;is&#x27;</span>, <span class="string">&#x27;better&#x27;</span>, <span class="string">&#x27;than&#x27;</span>, <span class="string">&#x27;ugly.&#x27;</span>]  <span class="comment">#以空白符分隔字符串</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">&#x27;\d+\.\d+\.\d+&#x27;</span>, <span class="string">&#x27;Python 3.8.5&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;3.8.5&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h2 id="精彩案例"><a href="#精彩案例" class="headerlink" title="精彩案例"></a>精彩案例</h2><p>使用正则表达式提取字符串中的电话号码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">telNumber = <span class="string">&#x27;&#x27;&#x27;Suppose my Phone No. is 0535-1234567, yours is 010-12345678, his is 025-87654321.&#x27;&#x27;&#x27;</span></span><br><span class="line">pattern = <span class="string">r&#x27;(\d&#123;3,4&#125;)-(\d&#123;7,8&#125;)&#x27;</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> re.findall(pattern, telNumber):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span>.join(item))</span><br></pre></td></tr></table></figure>

<p>由上面代码可得，在使用正则表达式有许多子模块时，查找的结果将与子模块匹配的字符串各自存元组中，然后将所有匹配得到的元组放在一个列表中。</p>
<h1 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h1><p>文件分为文本文件和二进制文件。文本文件为记事本文件、源程序文件这类存储字符串的文件。二进制文件将对象内容以字节串的形式进行存储，无法用记事本或其他普通处理软件直接进行编辑，需要专门的软件进行解码后读取、显示、进行操作，如图形文件、音视频文件、可执行文件、office文件等。</p>
<h2 id="内置函数open"><a href="#内置函数open" class="headerlink" title="内置函数open()"></a>内置函数open()</h2><p>open()的作用是将文件打开。</p>
<p>格式为：</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/10.png" alt="10"></p>
<p>常用的文件打开模式：</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/11.png" alt="11"></p>
<p>如果打开文件失败则会抛出异常。另外打开文件后一定要执行close()方法将文件关闭，确保修改生效。</p>
<h2 id="文件常用方法"><a href="#文件常用方法" class="headerlink" title="文件常用方法"></a>文件常用方法</h2><p>只有文本文件才有行的概念。</p>
<p><img src="/2021/06/26/python%E6%97%A5%E8%AE%B0-3/12.png" alt="12"></p>
<h2 id="上下文管理语句with"><a href="#上下文管理语句with" class="headerlink" title="上下文管理语句with"></a>上下文管理语句with</h2><p>关键字with可以自动管理资源，不论因为什么原因跳出with块，总能保证文件被正确关闭，并且可以在代码块执行完毕后自动还原进入该代码块时的上下文。</p>
<p>使用格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, mode, encoding) <span class="keyword">as</span> fp:</span><br><span class="line">	<span class="comment">#对文件对象fp读写的语句</span></span><br></pre></td></tr></table></figure>

<p>示例1：向文本文件中写入内容，然后再读出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;Hello world\n文本文件的读取方法\n文本文件的写入方法\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fp:   <span class="comment">#默认cp936编码方式</span></span><br><span class="line">    fp.write(s)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample.txt&#x27;</span>) <span class="keyword">as</span> fp:		<span class="comment">#默认cp936编码方式</span></span><br><span class="line">    <span class="built_in">print</span>(fp.read())</span><br></pre></td></tr></table></figure>

<p>示例2：文本文件可遍历</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample.txt&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> fp:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br></pre></td></tr></table></figure>

<p>示例3：假设文件data.txt中有若干整数，所有整数之间使用英文逗号分隔，编写程序读取所有整数，将其按升序排序后再写入文本文件data_asc.txt中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">	data = fp.readlines()				<span class="comment">#读取所有行</span></span><br><span class="line">data = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> data]  <span class="comment">#删除行两侧的空白</span></span><br><span class="line">data = <span class="string">&#x27;,&#x27;</span>.join(data).split(<span class="string">&#x27;,&#x27;</span>)		<span class="comment">#先以，将所有数字整合在一起，在用，把数字都切开</span></span><br><span class="line">data.sort(key=<span class="built_in">int</span>)						<span class="comment">#以数字大小排序</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data_asc.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">	fp.write(data)</span><br></pre></td></tr></table></figure>

<h2 id="二进制文件的读写"><a href="#二进制文件的读写" class="headerlink" title="二进制文件的读写"></a>二进制文件的读写</h2><h3 id="使用pickle模块读写二进制文件"><a href="#使用pickle模块读写二进制文件" class="headerlink" title="使用pickle模块读写二进制文件"></a>使用pickle模块读写二进制文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">i = <span class="number">130000</span></span><br><span class="line">a = <span class="number">99.056</span></span><br><span class="line">s = <span class="string">&#x27;中国 123abc&#x27;</span></span><br><span class="line">lst = [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]]</span><br><span class="line">tu = (-<span class="number">5</span>,<span class="number">10</span>,<span class="number">8</span>)</span><br><span class="line">coll = &#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</span><br><span class="line">dic = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;banana&#x27;</span>,<span class="string">&#x27;g&#x27;</span>:<span class="string">&#x27;orange&#x27;</span>&#125;</span><br><span class="line">data = (i,a,s,lst,tu,coll,dic)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample_pickle.dat&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pickle.dump(<span class="built_in">len</span>(data),f)    <span class="comment">#要序列化的对象个数</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> data:           <span class="comment">#序列化数据并写入文件</span></span><br><span class="line">            pickle.dump(item,f)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;写文件异常&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample_pickle.dat&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    n = pickle.load(f)              <span class="comment">#读出文件数据个数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):              <span class="comment">#自动识别数据边界</span></span><br><span class="line">        x = pickle.load(f)</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>



<h3 id="使用struct模块读写二进制文件"><a href="#使用struct模块读写二进制文件" class="headerlink" title="使用struct模块读写二进制文件"></a>使用struct模块读写二进制文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">n = <span class="number">130000</span></span><br><span class="line">x = <span class="number">96.45</span></span><br><span class="line">b = <span class="literal">True</span></span><br><span class="line">s = <span class="string">&#x27;a1@中国&#x27;</span></span><br><span class="line">sn = struct.pack(<span class="string">&#x27;if?&#x27;</span>, n, x, b)  <span class="comment">#序列化，i表示整数，f表示实数，？表示逻辑值</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample_struct.dat&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(sn)</span><br><span class="line">    f.write(s.encode())    <span class="comment">#字符串需先编码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sample_struct.dat&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    sn = f.read(<span class="number">9</span>)</span><br><span class="line">    tu = struct.unpack(<span class="string">&#x27;if?&#x27;</span>, sn)    <span class="comment">#指定格式反序列化</span></span><br><span class="line">    n1, x1, b1 = tu         <span class="comment">#序列解包</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n1=&#x27;</span>,n1,<span class="string">&#x27;x1=&#x27;</span>,x1,<span class="string">&#x27;b1=&#x27;</span>,b1)</span><br><span class="line">    s1 = f.read(<span class="number">9</span>).decode()     <span class="comment">#字符串解码</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;s1=&#x27;</span>,s1)</span><br></pre></td></tr></table></figure>

<p>序列化时，整数和实数序列化为4个字节，逻辑值序列化为1个字节。使用encode()为字符串编码时默认使用UTF-8，英文符号编码为1个字节，中文符号编码为3个字节。</p>
<h3 id="使用shelve模块操作二进制文件"><a href="#使用shelve模块操作二进制文件" class="headerlink" title="使用shelve模块操作二进制文件"></a>使用shelve模块操作二进制文件</h3><p>shelve标准库可以向操作字典一样操作二进制文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shelve</span><br><span class="line"></span><br><span class="line">zhangsan = &#123;<span class="string">&#x27;age&#x27;</span>:<span class="number">38</span>, <span class="string">&#x27;sex&#x27;</span>:<span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;address&#x27;</span>:<span class="string">&#x27;2235235&#x27;</span>&#125;</span><br><span class="line">lisi = &#123;<span class="string">&#x27;age&#x27;</span>:<span class="number">40</span>, <span class="string">&#x27;sex&#x27;</span>:<span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;tel&#x27;</span>:<span class="string">&#x27;7654321&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">with</span> shelve.<span class="built_in">open</span>(<span class="string">&#x27;shelve_test.dat&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    fp[<span class="string">&#x27;zhangsan&#x27;</span>] = zhangsan</span><br><span class="line">    fp[<span class="string">&#x27;lisi&#x27;</span>] = lisi</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        fp[<span class="built_in">str</span>(i)] = <span class="built_in">str</span>(i)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">with</span> shelve.<span class="built_in">open</span>(<span class="string">&#x27;shelve_test.dat&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="built_in">print</span>(fp[<span class="string">&#x27;zhangsan&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(fp[<span class="string">&#x27;zhangsan&#x27;</span>][<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(fp[<span class="string">&#x27;lisi&#x27;</span>][<span class="string">&#x27;tel&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(fp[<span class="string">&#x27;3&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h2 id="操作Excel文件和Word文件"><a href="#操作Excel文件和Word文件" class="headerlink" title="操作Excel文件和Word文件"></a>操作Excel文件和Word文件</h2><p>使用扩展库openpyxl读写Excel2007以及更高版本的文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line">fn = <span class="string">&#x27;test.xlsx&#x27;</span>      <span class="comment">#文件名</span></span><br><span class="line">wb = Workbook()       <span class="comment">#创建工作簿</span></span><br><span class="line">ws = wb.create_sheet(title=<span class="string">&#x27;你好，世界&#x27;</span>) <span class="comment">#创建工作表</span></span><br><span class="line">ws[<span class="string">&#x27;A1&#x27;</span>] = <span class="string">&#x27;这是第一个单元格&#x27;</span>    <span class="comment">#单元格赋值</span></span><br><span class="line">ws[<span class="string">&#x27;B1&#x27;</span>] = <span class="number">3.14</span></span><br><span class="line">wb.save(fn)     <span class="comment">#保存</span></span><br><span class="line"></span><br><span class="line">wb = openpyxl.load_workbook(fn)     <span class="comment">#打开已有的Excel文件</span></span><br><span class="line">ws = wb.worksheets[<span class="number">1</span>]       <span class="comment">#打开指定索引的工作表</span></span><br><span class="line"><span class="built_in">print</span>(ws[<span class="string">&#x27;A1&#x27;</span>].value)       <span class="comment">#读取并输出指定单元格的值</span></span><br><span class="line">ws.append([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])      <span class="comment">#添加一行数据</span></span><br><span class="line">ws.merge_cells(<span class="string">&#x27;F2:F3&#x27;</span>)     <span class="comment">#合并单元格</span></span><br><span class="line">ws[<span class="string">&#x27;F2&#x27;</span>] = <span class="string">&#x27;=sum(A2:E2)&#x27;</span>    <span class="comment">#写入公式</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">15</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">8</span>):</span><br><span class="line">        ws.cell(row=r,column=c,value=r*c)   <span class="comment">#写入单元格数据</span></span><br><span class="line">wb.save(fn)</span><br></pre></td></tr></table></figure>

<p>示例：检查word文档的连续重复字，例如“用户的的资料”或“需要需要用户输入”之类的情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line">doc = Document(<span class="string">&#x27;test_docx.docx&#x27;</span>)</span><br><span class="line">contents = <span class="string">&#x27;&#x27;</span>.join((p.text <span class="keyword">for</span> p <span class="keyword">in</span> doc.paragraphs))</span><br><span class="line">words = []</span><br><span class="line"><span class="keyword">for</span> index, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(contents[:-<span class="number">2</span>]):</span><br><span class="line">    <span class="keyword">if</span> ch == contents[index+<span class="number">1</span>] <span class="keyword">or</span> ch == contents[index+<span class="number">2</span>]:</span><br><span class="line">        word = contents[index:index+<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> words:</span><br><span class="line">            words.append(word)</span><br><span class="line">            <span class="built_in">print</span>(word)</span><br><span class="line"><span class="built_in">print</span>(words)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">的的资</span><br><span class="line">需要需</span><br><span class="line">要需要</span><br><span class="line">[&#x27;的的资&#x27;, &#x27;需要需&#x27;, &#x27;要需要&#x27;]</span><br></pre></td></tr></table></figure>


        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>John Doe</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://example.com/2021/06/26/python%E6%97%A5%E8%AE%B0-3/">http://example.com/2021/06/26/python%E6%97%A5%E8%AE%B0-3/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/python/"># python</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/06/27/python%E6%97%A5%E8%AE%B0-4/">python日记-4</a>
            
            
            <a class="next" rel="next" href="/2021/06/24/python%E6%97%A5%E8%AE%B0-2/">python日记-2</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© John Doe | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>